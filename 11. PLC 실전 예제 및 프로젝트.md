# 11. PLC 실전 예제 및 프로젝트

## 11.1 엘리베이터 제어 시퀀스

*(PLC를 활용한 대표적인 시퀀스 제어 실전 사례 — 엘리베이터 시스템 전체 흐름 구조 정리)*

------

### ✅ 개요

**엘리베이터 제어 시스템**은 PLC 시퀀스 제어에서 가장 전형적이고 실습·교육·실무에서도 많이 다루는 복합 시퀀스 모델이다.
 엘리베이터는 **다단계 상태 전이, 복수 입력 감지, 안전 장치, 호출 우선순위, 동기화 제어**가 동시에 요구된다.

------

### ✅ 1. 엘리베이터 기본 제어 흐름

```
대기 → 호출 → 승강 → 정지 → 문열림 → 승하차 → 문닫힘 → 다음 호출 처리
```

- 상태(State) 기반 상태 전이 시스템이 필수

------

### ✅ 2. 주요 입력 요소 (센서 및 신호)

| 입력                | 설명                                         |
| ------------------- | -------------------------------------------- |
| 층별 호출 스위치    | 각 층 외부에서 승강기 호출                   |
| 내부 목적지 스위치  | 탑승자가 층 지정                             |
| 도어 개폐 감지 센서 | 문 열림/닫힘 상태 확인                       |
| 층 위치 센서        | 현재 층 위치 감지 (리미트 스위치, 엔코더 등) |
| 과부하 센서         | 최대 적재 중량 초과 여부                     |
| 비상정지 스위치     | 긴급 상황 수동 정지                          |

------

### ✅ 3. 주요 출력 요소 (제어 대상)

| 출력         | 설명                       |
| ------------ | -------------------------- |
| 모터 제어    | 상승/하강 제어             |
| 도어 모터    | 문 열림/닫힘               |
| 층 도착 표시 | 디스플레이 및 음성 출력    |
| 경보 장치    | 경고음, 점멸등             |
| 속도 조절    | 인버터 제어 통한 감속/가속 |

------

### ✅ 4. 상태 전이(State Machine) 설계 예시

| 상태         | 설명                | 전이 조건                          |
| ------------ | ------------------- | ---------------------------------- |
| `IDLE`       | 대기 상태           | 호출 발생 시 → `MOVE`              |
| `MOVE`       | 상승 또는 하강 이동 | 도착층 도달 시 → `STOP`            |
| `STOP`       | 층 정지 상태        | 완전 정지 확인 → `DOOR_OPEN`       |
| `DOOR_OPEN`  | 문 열기             | 문 개방 완료 → `LOADING`           |
| `LOADING`    | 승하차 시간 대기    | 대기 시간 종료 → `DOOR_CLOSE`      |
| `DOOR_CLOSE` | 문 닫기             | 문 닫힘 완료 → `IDLE` or 다음 호출 |

> ※ 상태 전이 중 언제든 **Emergency** → 강제 `STOP` 전환

------

### ✅ 5. 호출 큐 관리 (Call Queue)

- 다층 엘리베이터는 **호출 우선순위 관리**가 필요
- FIFO, LIFO, 방향 우선순위 알고리즘 적용 가능

| 전략        | 설명                                 |
| ----------- | ------------------------------------ |
| 상향 우선   | 상승 중일 때 위쪽 호출 먼저 수행     |
| 하향 우선   | 하강 중일 때 아래쪽 호출 먼저 수행   |
| 목적지 버퍼 | 현재 방향 유지 후 반대방향 호출 대기 |

------

### ✅ 6. 래더 다이어그램 기본 논리 예시

#### ▶ 상승/하강 모터 제어

```
| 호출 층 > 현재 층 |───[ ]───( 상승 ON )
| 호출 층 < 현재 층 |───[ ]───( 하강 ON )
```

#### ▶ 도착 시 정지

```
| 호출 층 = 현재 층 |───[ ]───( 모터 OFF )  
                  └───( 도어 OPEN 시작 )
```

#### ▶ 도어 자동 닫힘

```
| 타이머 완료 |───[ ]───( 도어 CLOSE )
```

------

### ✅ 7. 안전 설계 요소

| 기능                | 설명                            |
| ------------------- | ------------------------------- |
| 과속 감시           | 엔코더 속도 비교                |
| 과부하 방지         | 중량 초과 감지시 정지           |
| 문 닫힘 감지        | 문 미닫힘 시 재개방             |
| 비상 정지           | 수동 또는 센서 이상시 즉시 정지 |
| 2중 브레이크 시스템 | 기계적·전기적 이중 안전 확보    |

------

### ✅ 8. 고급 제어 기능

| 기능                 | 설명                               |
| -------------------- | ---------------------------------- |
| 층간 정밀 정위치     | 엔코더 피드백 기반 정밀 정지       |
| 도어 개방 제한       | 특정 층, 무게 제한 시 개방 제한    |
| 자동 절전 운전       | 일정 대기 시간 후 자동 절전모드    |
| 그룹 엘리베이터 연동 | 다수 엘리베이터 협조 배차 알고리즘 |

------

### ✅ 9. 시각적 흐름도

```
[대기]
   ↓ (호출 발생)
[이동] → (도착층 감지) → [정지]  
   ↓ (속도 조정)
[문 열림] → [승하차 대기] → [문 닫힘] → [다음 호출]
```

- 각 블록은 **PLC 상태 변수(State 변수)**로 정의됨

------

### ✅ 10. 실무 PLC 구현 포인트

| 항목           | 설계 방법                     |
| -------------- | ----------------------------- |
| 상태 변수 관리 | INT ENUM 상태 변수 사용       |
| 호출 큐 관리   | 배열 또는 Shift Register 활용 |
| 안전 인터록    | 릴레이+PLC 이중 인터록 병행   |
| 모터 속도 제어 | 인버터 제어 연동              |
| 유지보수 모드  | 수동 운전 모드 별도 구현      |

------

### ✅ 정리

- 엘리베이터 제어는 **상태 기반 시퀀스 제어의 대표적 실전 사례**
- **상태 전이 제어 + 호출 우선순위 알고리즘 + 안전 인터록**이 핵심 설계 포인트
- 실습/프로젝트/시험 대비에도 가장 많이 다뤄지는 시퀀스 모델

## 11.2 컨베이어 시스템 제어

*(PLC 실전 시퀀스 제어에서 가장 기초적이면서 응용도가 높은 컨베이어 시스템의 제어 설계)*

------

### ✅ 개요

**컨베이어 시스템**은 물류, 생산, 가공, 검사 라인 등 모든 산업 자동화 시스템에서 필수적인 핵심 장비다.
 컨베이어 제어는:

- 단순 연속동작부터
- 센서 기반 자동 분기,
- 타이밍 연동,
- 다중 라인 동기화까지

다양한 시퀀스 제어 설계가 필요하다.

------

### ✅ 1. 컨베이어 제어 기본 흐름

```
준비 → 시작 → 가동 → 감지 → 분기 → 정지 → 대기
```

- 흐름에 따라 여러 센서와 액추에이터가 순차 동작

------

### ✅ 2. 주요 제어 요소

| 요소          | 설명                      |
| ------------- | ------------------------- |
| Start 버튼    | 시스템 시작 신호          |
| Stop 버튼     | 수동 정지 신호            |
| 비상 정지     | 긴급 상황 수동 차단       |
| 포토센서      | 물체 감지 (입출입 확인)   |
| 인덕티브 센서 | 금속 감지                 |
| Limit 스위치  | 위치 감지                 |
| 분기 장치     | 방향 전환 (실린더, 암 등) |
| 모터 인버터   | 속도 제어 (VFD 제어 가능) |
| 타이머        | 시간 기반 분기            |

------

### ✅ 3. 기본 컨베이어 시퀀스 예시

| 상태            | 동작                      |
| --------------- | ------------------------- |
| `IDLE`          | 대기, 모든 모터 정지      |
| `RUN`           | 모터 구동, 물체 이동 시작 |
| `SENSOR DETECT` | 물체 감지, 분기 준비      |
| `SORTING`       | 분기 장치 동작            |
| `STOP`          | 작업 종료                 |

------

### ✅ 4. 래더 다이어그램 기본 제어 예시

#### ▶ 컨베이어 시작-정지 회로 (자기 유지 회로)

```
| Start 버튼 |───[ ]───┬───( SET Run_Flag )
| Stop 버튼  |───[ ]───┘
| Run_Flag   |───[ ]───( 컨베이어 모터 ON )
```

- 자기 유지 회로 (Self-Holding Circuit)
- Start 누르면 유지, Stop 누르면 해제

------

#### ▶ 물체 감지 후 분기 동작

```
| 포토센서 |───[ ]───( 타이머 T1 ON )

| T1 완료 |───[ ]───( Sorting Arm ON )
```

- 감지 후 일정 시간 지연 후 분기 동작

------

### ✅ 5. 안전 설계 요소

| 항목             | 설명                         |
| ---------------- | ---------------------------- |
| 비상 정지        | 하드와이어 릴레이 차단 우선  |
| 양방향 회전 제한 | 방향 오류 방지 인터록        |
| 과부하 감지      | 전류 감지 통한 모터 보호     |
| 라인 충돌 방지   | 각 컨베이어 구간 연동 인터록 |

------

### ✅ 6. 다중 컨베이어 연동 (Multi-Zone Synchronization)

| 구간            | 연동 방식                         |
| --------------- | --------------------------------- |
| 구간 A → 구간 B | A의 센서 감지 → B 구동 시작       |
| 분기 시스템     | 센서 신호에 따라 선택적 라인 전환 |
| 적재 대기       | B 가득 찼을 경우 A 자동 대기      |

#### 📌 래더 연동 예시

```
| ZoneB_Full |───[/]───┬───( ZoneA_Run 허용 )
| ZoneB_Full |───[ ]───┘
```

- ZoneB가 가득 차면 ZoneA는 자동 정지 (연속 충돌 방지)

------

### ✅ 7. 고급 제어 응용

| 기능           | 설명                               |
| -------------- | ---------------------------------- |
| 속도 조정      | 인버터 제어, 속도 프로파일 변경    |
| 분기 최적화    | RFID, 바코드 읽어 목적지 선택      |
| AGV 연동       | 이동형 컨베이어 자동 연동          |
| 품질 검사 연계 | 검출 이상품 자동 분리              |
| SCADA 연동     | 전체 라인 실시간 감시 및 통계 기록 |

------

### ✅ 8. 시각적 흐름도 예

```
[대기]
  ↓ (Start)
[이동 중]
  ↓ (센서 감지)
[분기 준비]
  ↓ (분류 동작)
[다음 제품 대기]
```

- 각 상태는 **PLC State 변수**로 구성

------

### ✅ 9. 실무 PLC 구현 시 핵심 포인트

| 항목               | 설계 원칙                           |
| ------------------ | ----------------------------------- |
| 센서 노이즈 필터링 | 디바운싱 적용 (짧은 순간 신호 무시) |
| 타이밍 정합        | 분기 장치 구동 지연시간 정확히 설정 |
| 충돌 방지          | 분기 완료 후 다음 제품 투입 허용    |
| 유지보수           | 모든 구간 수동 운전 모드 구현       |
| 알람 시스템        | 센서 이상, 모터 오류 즉시 알람 출력 |

------

### ✅ 10. 실전 적용 사례

| 산업 현장   | 적용 형태                      |
| ----------- | ------------------------------ |
| 전자 제조   | SMT 라인 자동 피더             |
| 물류센터    | 자동 분류기, 스캐너 연동       |
| 식음료 생산 | 병입 라인, 충진, 라벨링 동기화 |
| 자동차 조립 | 부품 이동 자동 라인            |
| 택배 허브   | 바코드 기반 자동 분류기        |

------

### ✅ 정리

- **컨베이어 시스템은 PLC 시퀀스 제어의 기초부터 심화까지 모두 실습 가능한 교과서적 모델**
- **자기유지 회로, 센서 감지, 타이밍 분기, 다중 구간 동기화, 안전 인터록**이 설계의 핵심
- 현장에 따라 다양한 **분기 알고리즘, 품질검사 연동, 데이터 로깅**까지 확장 가능

## 11.3 혼합 탱크 자동제어 (온도, 유량)

*(PLC 기반 복합 제어 시스템의 실전 사례 — 프로세스 제어형 시퀀스의 핵심 구조 정리)*

------

### ✅ 개요

**혼합 탱크(Mixing Tank) 제어 시스템**은 단순한 시퀀스가 아니라
 **연속 공정 제어 (Continuous Process Control)**와
 **피드백 루프 (Feedback Control: 온도, 유량 등)**를 복합적으로 포함하는 고급 PLC 제어 사례다.

특히:

- 이중/다중 입력 (온도, 유량, 압력)
- 연속 제어 (PID, 레벨 유지)
- 안전 인터록
- 레시피 기반 제어

등이 통합적으로 요구된다.

------

### ✅ 1. 시스템 전체 흐름 개요

```
준비 → 원료 주입 → 혼합 → 가열 → 품질 검사 → 배출 → 세척 → 대기
```

- **시퀀스 기반 상태 전이** + **피드백 기반 연속제어** 동시 구성

------

### ✅ 2. 주요 입력 신호

| 입력                          | 설명                                     |
| ----------------------------- | ---------------------------------------- |
| Start 버튼                    | 공정 시작 신호                           |
| 유량 센서 (Flow Meter)        | 원료 주입 속도 감지                      |
| 온도 센서 (RTD, Thermocouple) | 가열 제어용                              |
| 레벨 센서                     | 액체 높이 감지                           |
| 압력 센서                     | 내부 압력 감시                           |
| 비상 정지 스위치              | 전체 공정 정지                           |
| 품질 검사 신호                | 혼합 균질도 확인 (외부 검사기 연계 가능) |

------

### ✅ 3. 주요 출력 제어 대상

| 출력           | 설명           |
| -------------- | -------------- |
| 원료 주입 밸브 | 재료 유입 제어 |
| 교반기 모터    | 혼합 회전 제어 |
| 히터           | 온도 유지      |
| 배출 밸브      | 완성액 배출    |
| 세척 노즐      | 세척수 분사    |

------

### ✅ 4. 시퀀스 상태 전이 설계 예시

| 상태            | 동작           | 전이 조건             |
| --------------- | -------------- | --------------------- |
| `IDLE`          | 준비 대기      | Start 버튼            |
| `FILLING`       | 원료 주입      | 목표 레벨 도달        |
| `MIXING`        | 교반 가동      | 유량 정상 유지        |
| `HEATING`       | PID 온도 제어  | 목표 온도 도달        |
| `QUALITY_CHECK` | 샘플 검사      | 합격 시 → `DISCHARGE` |
| `DISCHARGE`     | 배출 밸브 ON   | 배출 완료 시 종료     |
| `CLEANING`      | 세척 과정      | 세척 완료             |
| `ERROR`         | 안전 이상 발생 | 수동 리셋 후 복귀     |

------

### ✅ 5. 온도 제어 — PID 루프 구성

#### 📌 제어 변수 구성

| 요소                  | 설명           |
| --------------------- | -------------- |
| Setpoint (SP)         | 목표 온도      |
| Process Variable (PV) | 현재 탱크 온도 |
| Control Output (MV)   | 히터 출력 비율 |

#### 📌 PID 래더 블록 예시 (ST 언어)

```
PID1(SP := Target_Temperature,
     PV := Tank_Temperature,
     KP := 1.2,
     TI := 60.0,
     TD := 10.0,
     MV => Heater_Output);
```

- 대부분 PLC에 **PID Function Block 내장**

------

### ✅ 6. 유량 제어 — 실시간 피드백 루프

- Flow Meter → 유입량 실시간 감지
- 목표 유량 유지하도록 밸브 조절 가능 (유량 PID 제어 가능)

```
PID_Flow(SP := Target_FlowRate,
         PV := Current_Flow,
         MV => Inlet_Valve_Position);
```

------

### ✅ 7. 전체 제어 흐름 시각도

```
[대기]
  ↓
[원료 주입 (유량 제어)]
  ↓
[혼합 교반]
  ↓
[가열 (온도 PID)]
  ↓
[품질 검사]
  ↓
[완성 배출]
  ↓
[탱크 세척]
  ↓
[다음 생산 준비]
```

------

### ✅ 8. 알람 및 안전 설계

| 항목          | 설명                                     |
| ------------- | ---------------------------------------- |
| 과압력 감지   | 즉시 히터 OFF, 밸브 개방                 |
| 유량 이상     | 재료 공급 차단                           |
| 온도 과열     | 히터 자동 차단                           |
| 교반기 과부하 | 모터 보호 정지                           |
| 이중 안전     | 하드와이어 인터록 + 소프트웨어 보호 병행 |

------

### ✅ 9. 레시피 기반 자동제어 설계

#### 📌 레시피 테이블 예시

| 제품   | 온도 | 교반속도 | 유량    | 혼합시간 |
| ------ | ---- | -------- | ------- | -------- |
| 제품 A | 70℃  | 200 rpm  | 500 L/h | 15분     |
| 제품 B | 90℃  | 250 rpm  | 600 L/h | 10분     |

- HMI/SCADA 레시피 화면 → PLC 변수 자동 적용 → 무오류 운전 가능

------

### ✅ 10. 실무 PLC 시퀀스 설계 포인트

| 항목        | 구현 방법                               |
| ----------- | --------------------------------------- |
| 상태관리    | 상태 전이 변수 (State ENUM) 사용        |
| 병렬제어    | 교반기, 히터, 유량 각각 독립 제어       |
| 알람 인터록 | 모든 PID 루프에 상한/하한 제한 삽입     |
| 유지보수    | 수동운전 모드 별도 구현                 |
| 이력 기록   | 유량·온도 트렌드 이력 저장 → SCADA 연동 |

------

### ✅ 11. 실전 적용 산업 예시

| 산업   | 적용 예시                   |
| ------ | --------------------------- |
| 식품   | 소스 제조, 음료 혼합        |
| 화학   | 반응조 온도/유량 동시 제어  |
| 제약   | 멸균 배양조, 정밀 농도 유지 |
| 화장품 | 로션, 샴푸 혼합 공정        |
| 반도체 | 슬러리 혼합, 도금액 제조    |

------

### ✅ 정리

- **혼합탱크 제어는 시퀀스 제어 + PID 연속제어가 결합된 전형적 복합 공정**
- 상태전이 제어(State Machine)와 연속 피드백 제어(PID)가 정확히 협력하도록 설계
- **레시피 기반 자동제어** 도입 시 품질 일관성 극대화 가능
- PLC, HMI, SCADA, 데이터로깅 시스템 통합 설계의 훌륭한 실습 모델

## 11.4 자동문, 조명 제어 시스템

*(PLC 시퀀스 제어의 기초적이면서 산업·건물 자동화에서 매우 실용적인 실전 제어 사례)*

------

### ✅ 개요

**자동문과 조명 제어**는 단순한 ON/OFF 제어 같아 보이지만
 현장에서는 반드시 **센서 기반 논리, 시퀀스 흐름, 안전 보호, 에너지 절감**이 결합되어야 하는
 **고전적인 PLC 입문 실전 예제이자 실무 시스템 핵심**이다.

이들은 제조공장, 물류센터, 건물 자동화, 무인 시스템 등에서 매우 폭넓게 활용된다.

------

### ✅ 1. 자동문 기본 시퀀스 흐름

```
대기 → 접근 감지 → 문 열림 → 출입 감지 → 문 닫힘 → 대기 복귀
```

- 주요 핵심: **센서 동기화** + **타이밍 제어** + **비상 인터록**

------

### ✅ 2. 자동문 제어 구성 요소

| 구성 요소                    | 설명                    |
| ---------------------------- | ----------------------- |
| 근접 센서 (PIR, 초음파)      | 접근자 감지             |
| 출입 감지 센서 (Beam Sensor) | 통과 감지               |
| 도어 모터                    | 슬라이딩/스윙 도어 개폐 |
| 도어 개폐 감지 스위치        | 열림/닫힘 위치 확인     |
| 안전 센서                    | 끼임 방지, 장애물 감지  |
| 비상 정지 스위치             | 긴급 차단               |
| 문 닫힘 타이머               | 자동 닫힘 대기시간 설정 |

------

### ✅ 3. 자동문 기본 래더 시퀀스 예시

#### ▶ 문 열기 조건

```
| 접근 센서 감지 |───[ ]───┬───( 도어 개방 )
| 출입 감지 |──────[ ]───┘
```

#### ▶ 닫힘 타이머 제어

```
| 도어 개방 완료 |───[ ]───( T1 ON )

| T1 완료 |───[ ]───( 도어 닫힘 )
```

#### ▶ 안전 끼임 방지

```
| 닫힘 중 AND 안전센서 감지 |───[ ]───( 즉시 재개방 )
```

- 센서 조합이 단순할수록 현장 신뢰성 높아짐

------

### ✅ 4. 자동문 시퀀스 상태 전이 모델

| 상태        | 설명                        | 전이조건       |
| ----------- | --------------------------- | -------------- |
| `IDLE`      | 대기                        | 접근 감지      |
| `OPENING`   | 문 열림                     | 열림 완료 감지 |
| `HOLDING`   | 대기                        | 닫힘 타이머    |
| `CLOSING`   | 문 닫힘                     | 닫힘 완료      |
| `REOPENING` | 안전센서 감지시 즉시 재개방 |                |

------

### ✅ 5. 조명 제어 시스템 기본 흐름

```
대기 → 접근 감지 → 점등 → 무인감지 → 소등
```

- **에너지 절감 + 안전성** 중심 제어

------

### ✅ 6. 조명 제어 구성 요소

| 구성 요소          | 설명                            |
| ------------------ | ------------------------------- |
| PIR 인체 감지 센서 | 인원 감지                       |
| 타이머             | 점등 유지시간 설정              |
| 광센서 (조도센서)  | 외부 밝기 감지 (주간 자동 소등) |
| 수동 스위치        | 수동 조작 허용                  |
| 조명등 릴레이      | 부하 ON/OFF 제어                |

------

### ✅ 7. 조명 래더 제어 예시

#### ▶ 점등 논리

```
| 인체 감지 AND (야간 조건) |───[ ]───( 조명 ON )
```

#### ▶ 소등 타이머

```
| 인체 감지 해제 |───[↑]───( T1 ON )

| T1 완료 |───[ ]───( 조명 OFF )
```

#### ▶ 수동 스위치 우선

```
| 수동 스위치 ON |───[ ]───( 조명 항상 ON )
```

- **수동-자동 논리 우선순위** 반드시 설정

------

### ✅ 8. 통합 제어 예시 (복합 시스템)

- 자동문 + 조명 시스템 연계 가능
- 출입 감지 → 문 열림 → 실내 조명 자동 점등
- 조명 유지 → 출입 종료 후 자동 소등

#### 📌 통합 흐름도 예

```
접근 감지 → 문 개방 → 조명 점등  
   ↓ (퇴실 감지 후 대기시간 경과)  
문 닫힘 → 조명 소등
```

------

### ✅ 9. 실무 고급 적용 요소

| 기능          | 설명                                |
| ------------- | ----------------------------------- |
| 절전모드      | 일정 시간 무작동 시 전체 소등       |
| 스케줄제어    | 시간대별 자동 점등 (조명스케줄)     |
| 통합 BMS 연동 | 건물 전체 중앙 통제 통합            |
| 장애감지      | 센서 이상 시 경고 알람              |
| 원격 제어     | SCADA/HMI 상에서 상태 모니터링 가능 |

------

### ✅ 10. 실전 적용 현장 예시

| 산업현장      | 적용 사례                           |
| ------------- | ----------------------------------- |
| 물류센터      | 출입문 + 구역별 자동 조명           |
| 병원, 공항    | 접근 기반 자동문 + 경보시스템       |
| 자동화 공장   | 안전 구역 자동 게이트               |
| 대형 쇼핑몰   | 복합 동작: 출입/조명/환기 자동 통합 |
| 반도체 공정실 | 에어샤워 자동문 동기화 제어         |

------

### ✅ 정리

- **자동문, 조명 시스템은 센서 기반 시퀀스 제어의 기초 완성형 예제**
- 단순 ON/OFF 제어가 아니라 **센서, 타이머, 안전, 다단계 논리**가 결합되어야 실무 시스템 가능
- 현대 PLC 실습 과정에서 반드시 완전 구현 가능한 가장 실용적인 시퀀스 연습 모델

## 11.5 포장/배출 자동화 설계

*(PLC 시퀀스 제어의 공정 자동화 대표 사례 — 생산라인 말단 자동 포장 및 배출 시스템의 제어 설계)*

------

### ✅ 개요

**포장/배출 자동화 시스템**은 생산라인의 최종단에서 완제품을:

- 포장(봉함, 밀봉, 라벨 부착 등)
- 적재(박스, 팔레트)
- 배출(물류 시스템 연동)

까지 자동으로 처리하는 공정이다.

이 시스템은 **PLC 시퀀스 제어, 센서 피드백, 위치검사, 안전 인터록, 타이밍 정합**의 종합설계가 요구된다.

------

### ✅ 1. 전체 시퀀스 흐름 개요

```
제품 도착 → 위치 감지 → 포장 준비 → 포장 동작 → 검사 → 배출 → 다음 사이클
```

- 기본적으로 **이벤트 기반 상태전이(State Machine)** 설계가 필수

------

### ✅ 2. 주요 제어 대상 및 구성요소

| 제어 요소  | 설명                                         |
| ---------- | -------------------------------------------- |
| 센서       | 포토센서, 리미트 스위치, 라벨 인식, 무게센서 |
| 포장기     | 봉함기, 라벨부착기, 밀봉기                   |
| 이송 모터  | 컨베이어, 롤러, 로봇암                       |
| 팔레타이저 | 완성품 적재 장치                             |
| 배출 장치  | 적재 완료 후 다음 라인 송출                  |
| 비전검사기 | 포장 불량, 라벨 누락 검출                    |
| 안전장치   | 방호문 스위치, 비상정지                      |

------

### ✅ 3. 시퀀스 상태 전이 설계 예시

| 상태          | 동작           | 전이 조건         |
| ------------- | -------------- | ----------------- |
| `IDLE`        | 대기           | 제품 감지         |
| `POSITIONING` | 포장 위치 이동 | 위치 완료         |
| `PACKAGING`   | 봉함, 라벨링   | 완료 감지         |
| `INSPECTION`  | 검사기 통과    | 합격 여부         |
| `PALLETIZING` | 적재 장치 이동 | 위치확인          |
| `DISCHARGE`   | 배출라인 이동  | 종료 확인         |
| `ERROR`       | 장애 발생      | 수동 리셋 후 복귀 |

------

### ✅ 4. 기본 래더 제어 예시

#### ▶ 제품 감지 후 포장 준비

```
| 포토센서 감지 |───[ ]───( 컨베이어 정지 )
| 위치센서 완료 |───[ ]───( 포장기 스타트 )
```

#### ▶ 포장 완료 후 검사로 전이

```
| 포장기 완료신호 |───[ ]───( 검사기 스타트 )
```

#### ▶ 불량 분기 (비전 검사 포함)

```
| 검사기 불량감지 |───[ ]───( 불량품 배출 장치 ON )
| 검사기 합격 |───[ ]───( 팔레타이저 이동 )
```

------

### ✅ 5. 팔레타이징 제어 흐름 예시

- **적재 패턴 계산 알고리즘 필요**
- 예: 박스당 5×5 적재 → 팔레트 높이계산 포함

#### ▶ 적재 카운터 예시

```
| 적재 완료시 |───[ ]───( 카운터 증가 )

| 카운터 = 목표 |───[ ]───( 팔레트 교환 신호 )
```

- 팔레트 교체 → 이송기 자동 재설정

------

### ✅ 6. 동기화 제어 핵심 요소

| 제어 동기화      | 설명                                 |
| ---------------- | ------------------------------------ |
| 속도 정합        | 제품 공급 → 포장기 동작 속도 일치    |
| 다중 인터록      | 포장 미완료 시 배출 금지             |
| 타이밍 제어      | 동작 간 간격 최적 설정               |
| 장비간 동작 중첩 | 다음 공정이 선행 공정 완료 신호 대기 |

------

### ✅ 7. 안전 설계 요소

| 위험        | 대응 방안             |
| ----------- | --------------------- |
| 손 끼임     | 방호 커버 스위치      |
| 장비 과부하 | 모터 토크 감지        |
| 비상정지    | 전체 시스템 하드 차단 |
| 정위치 실패 | 이중 센서 감지 구조   |
| 팔레트 넘침 | 레벨센서 이중 확인    |

------

### ✅ 8. 알람 및 이력 로깅

- 장비 별 동작 실패 → 알람코드 부여
- 불량 이력 → 품질 분석용 DB 기록
- 팔레트 교환 기록 → 물류 관리 통합

------

### ✅ 9. 고급 연동 설계

| 연계 시스템            | 활용                      |
| ---------------------- | ------------------------- |
| ERP/MES 연동           | 실시간 생산량 데이터 전송 |
| 물류 AGV 연계          | 팔레트 자동 운반          |
| SCADA 연동             | 전체 공정 통합 모니터링   |
| 클라우드 원격 모니터링 | 생산이력 분석, OEE 관리   |

------

### ✅ 10. 실전 적용 산업 예시

| 산업 분야 | 적용 사례                      |
| --------- | ------------------------------ |
| 식음료    | 병입 포장, 라벨링, 박스 적재   |
| 전자부품  | PCB 봉함, 정전기포장, 라벨부착 |
| 제약      | 의약품 블리스터 포장, 밀봉     |
| 화학      | 분말·액체 드럼 포장            |
| 물류센터  | 자동 소형 박스 분류·적재       |

------

### ✅ 정리

- 포장/배출 자동화는 **PLC 시퀀스 제어의 고급 종합형 실전 과제**
- **상태전이 흐름 + 센서 피드백 + 알람 인터록 + 다중 장비 동기화**가 핵심
- 실무에서는 **로봇/AGV/물류 시스템까지 통합 자동화 설계**로 확장

## 11.6 제조 설비에서의 생산 관리 연동

*(PLC 기반 생산 설비를 상위 생산관리 시스템(MES, ERP)와 통합하는 구조 설계)*

------

### ✅ 개요

PLC로 제어되는 제조설비는 단순히 장비 동작만 담당하지 않는다.
 현대 공장에서는 **상위 생산관리 시스템(MES: Manufacturing Execution System)** 과 연동되어야 한다.
 이 연동을 통해:

- 실시간 생산량 집계
- 품질 데이터 수집
- 설비 가동률(OEE) 관리
- 작업 지시 자동화
- 추적성(Traceability) 확보

가 가능해진다.

------

### ✅ 1. 전체 시스템 계층 구조

```
ERP (Enterprise Resource Planning)
         ↓  
MES (Manufacturing Execution System)
         ↓  
SCADA (Supervisory Control)
         ↓  
PLC (제어 및 현장 I/O)
```

- **PLC는 실시간 제어**,
- **MES는 생산관리·지시·이력통합 담당**

------

### ✅ 2. MES ↔ PLC 연동 필요 이유

| 목적               | 설명                                           |
| ------------------ | ---------------------------------------------- |
| 생산지시           | 작업자 수동 입력 없이 PLC가 작업 파라미터 수신 |
| 실시간 생산량 수집 | 생산수량, 불량수량, 속도 실시간 보고           |
| 품질 이력 확보     | 검사 결과, 공정변수 저장                       |
| 추적성             | 제품별 이력 데이터 (LOT, Serial No 등)         |

------

### ✅ 3. 주요 통신 방식

| 방식     | 설명                                         |
| -------- | -------------------------------------------- |
| OPC UA   | 표준화된 실시간 태그 교환 (가장 많이 사용됨) |
| MQTT     | IIoT 기반 경량 메시지 송수신                 |
| DB 연동  | PLC가 SCADA/MES 연동 서버의 DB 직접 갱신     |
| REST API | 웹 기반 연동 (클라우드 MES 연동 시 활용)     |

------

### ✅ 4. 통신 흐름 예시

#### 📌 생산지시 흐름

```
MES → (작업오더 전송) → SCADA → PLC 레시피 세팅 → 생산개시
```

#### 📌 생산실적 보고 흐름

```
PLC 생산량 카운터 → SCADA → MES 실시간 생산 실적 DB 기록
```

#### 📌 품질이력 수집 흐름

```
검사결과, 센서 데이터 → PLC → SCADA 이력 기록 → MES 품질분석 DB
```

------

### ✅ 5. 데이터 항목 구성 예시

| 데이터 항목    | 설명                |
| -------------- | ------------------- |
| 생산오더번호   | 작업지시 고유번호   |
| 제품모델       | 현재 생산 제품 코드 |
| 작업자         | 작업자 식별 정보    |
| 생산수량       | 누적 생산량         |
| 불량수량       | 검사 불량 수량      |
| 온도/압력 이력 | 공정 주요 품질 변수 |
| 시작/종료 시간 | 공정 단위 시간 기록 |

------

### ✅ 6. 연동 설계 실전 구성 예시

```
[PLC] ↔ [SCADA 서버] ↔ [MES 서버]
           ↕
    [DB 서버 (이력 기록)]
           ↕
    [ERP 서버 (경영통계)]
```

- MES가 SCADA를 통해 PLC 데이터를 직접 수집하거나
- MES가 OPC UA 게이트웨이를 통해 PLC 태그에 직접 접근

------

### ✅ 7. 작업지시 레시피 자동 세팅 예시

- MES가 다음 작업지시 송신 → SCADA → PLC 레시피 설정:

| 파라미터  | 내용      |
| --------- | --------- |
| 목표 속도 | 120 m/min |
| 압력 설정 | 3.2 bar   |
| 온도 설정 | 95°C      |
| 혼합비율  | 70:30     |

```
PLC:
Speed_Set := MES_Speed;
Pressure_Set := MES_Pressure;
Temp_Set := MES_Temperature;
Mix_Ratio := MES_Ratio;
```

------

### ✅ 8. 실시간 모니터링 화면 예시

- SCADA 및 MES 화면에 다음과 같은 정보가 실시간 표시

| 항목          | 예시 표시              |
| ------------- | ---------------------- |
| 생산라인 상태 | RUNNING / IDLE / ALARM |
| 현재 생산량   | 12,300개               |
| 불량율        | 1.2%                   |
| 가동률 (OEE)  | 92%                    |
| 공정 온도     | 94.8°C                 |
| 라인 작업자   | ID: OP567              |

------

### ✅ 9. 안전 및 보안 고려사항

| 항목          | 설계 원칙                              |
| ------------- | -------------------------------------- |
| 네트워크 구분 | 제어망과 IT망 분리 (Firewall, VLAN)    |
| 접근 인증     | MES → PLC 통신에 인증서 기반 접근 제한 |
| 데이터 이중화 | 생산이력 실시간 백업                   |
| 장애 복구     | 서버 이중화, 이력 재처리 기능 확보     |

------

### ✅ 10. 실전 적용 산업 예시

| 산업분야 | 적용 사례                      |
| -------- | ------------------------------ |
| 자동차   | 조립라인 생산이력 통합관리     |
| 식음료   | 레시피 기반 생산지시 자동 설정 |
| 전자     | 실시간 양품/불량율 모니터링    |
| 반도체   | 정밀 공정 변수 이력 기록       |
| 제약     | 전공정 제조이력 추적 시스템    |

------

### ✅ 정리

- **PLC ↔ MES 연동은 제조자동화 시스템의 핵심 상위통합 단계**
- 생산지시 수신, 생산실적 보고, 품질이력 수집, 가동률 관리까지 전 과정을 통합
- OPC UA 기반 통합 설계가 현재 가장 표준적이고 안정적인 방식
- 이 설계가 성공해야 **스마트팩토리의 핵심 데이터 흐름 기반이 완성**된다.

## 11.7 에러코드 및 로그 처리

*(PLC 제어 시스템에서 고장 진단, 유지보수, 이력분석을 위한 핵심 장애 처리 구조 설계)*

------

### ✅ 개요

PLC 시스템은 실시간으로 장비를 제어하지만,
 **에러코드 관리 및 로그 이력 기록 시스템이 제대로 설계되지 않으면**
 장비 이상 발생 시 정확한 원인 파악과 복구가 어려워진다.

따라서 **에러코드 체계화 + 상세 이력 로깅 + 실시간 알람 출력**은
 모든 산업용 제어 시스템의 **핵심 유지보수 설계 요소**다.

------

### ✅ 1. 에러코드 관리의 필요성

| 목적             | 설명                             |
| ---------------- | -------------------------------- |
| 고장 원인 명확화 | 진단 속도 향상                   |
| 반복 장애 예방   | 패턴 분석 가능                   |
| 유지보수 효율화  | 수리 시간 단축                   |
| 상위 시스템 통합 | SCADA, MES 알람 시스템 연계 가능 |

------

### ✅ 2. 에러코드 체계 설계 원칙

#### 📌 코드 구조 예시

| 코드 번호 | 분류            | 상세 설명                     |
| --------- | --------------- | ----------------------------- |
| 01xx      | 센서 오류       | 위치 센서 이상, 감지 실패     |
| 02xx      | 모터 이상       | 과전류, 과부하, 인버터 이상   |
| 03xx      | 통신 장애       | PLC ↔ I/O 단절, 통신 타임아웃 |
| 04xx      | 공정 오버플로우 | 탱크 레벨 초과, 유량 이상     |
| 05xx      | 안전장치 트립   | 방호문 열림, 비상정지         |
| 99xx      | 시스템 오류     | 프로그램 이상, 메모리 오류    |

------

#### 📌 코드 구성 원칙

- **에러 그룹화 (대분류 → 상세분류)**
- **숫자 범위 예약** (나중 확장 고려)
- **중복 코드 방지**
- **단일 에러는 단일 코드에만 대응**

------

### ✅ 3. 래더 기반 에러코드 생성 예시

#### ▶ 단일 센서 이상 감지

```
| 위치센서 미감지 |───[ ]───( Error_Code := 0101 )
```

#### ▶ 다중 우선순위 평가

```
| 비상정지 |───[ ]───( Error_Code := 0501 )
| 센서이상 |───[ ]───( Error_Code := 0101 )
```

- 상위 위험도가 높은 에러코드 우선 설정

------

### ✅ 4. 에러코드 이력 로깅 설계

| 기록 항목   | 설명                      |
| ----------- | ------------------------- |
| 발생 시간   | 정확한 Timestamp          |
| 에러 코드   | 고유 번호 기록            |
| 원인 설명   | 코드별 자동 메시지 연결   |
| 발생 위치   | 장비 번호, 라인 번호 포함 |
| 조치자 기록 | 확인·해제 담당자          |

------

#### 📌 SCADA 연동 이력 테이블 예시

| 시간             | 장비  | 코드 | 원인        | 확인자 |
| ---------------- | ----- | ---- | ----------- | ------ |
| 2025-06-17 10:32 | Line1 | 0203 | 인버터 과열 | O.정석 |
| 2025-06-17 10:35 | Line1 | 0501 | 비상정지    | 관리자 |

------

### ✅ 5. 실시간 알람 시스템 연계

- **PLC → SCADA 알람 시스템 자동 연동**
- 발생 즉시 화면 표시, 점멸, 음향 경보 출력

#### 📌 알람 출력 흐름

```
PLC Error Code ON  
   ↓  
SCADA 알람 서버  
   ↓  
운영자 알림 / SMS / 이메일 / 모바일 알림
```

------

### ✅ 6. 에러코드 해제(Reset) 논리 설계

| 단계                  | 조건                    |
| --------------------- | ----------------------- |
| ① 장애 원인 제거 확인 | 센서 정상, 모터 복귀 등 |
| ② 수동 확인 버튼      | 운영자 승인 입력        |
| ③ 에러코드 클리어     | Error_Code := 0000      |

※ 위험장애일수록 **이중 확인 로직** 적용

------

### ✅ 7. 고급 로그 시스템 설계 요소

| 요소                     | 설명                    |
| ------------------------ | ----------------------- |
| 이력 검색 기능           | 기간, 장비, 코드별 조회 |
| 통계 분석                | 반복 장애 패턴 도출     |
| 예방정비 연계            | 고장 전조 탐지 가능     |
| 클라우드 연계            | 중앙 원격 장애 모니터링 |
| 유지보수 리포트 자동생성 | 관리자 보고 자동화      |

------

### ✅ 8. 현장 유지보수 실전 활용

| 적용 사례          | 설명                                         |
| ------------------ | -------------------------------------------- |
| 비상정지 이력 분석 | 작업자 실수 vs 기계오작동 구분               |
| 센서 반복불량 패턴 | 센서 교체 시기 판단 근거 제공                |
| 통신장애 카운트    | PLC ↔ I/O 단선 위험 조기 대응                |
| 설비노후 예지      | 모터 과부하 발생 패턴으로 예방정비 계획 수립 |

------

### ✅ 9. 실전 적용 산업 예시

| 산업        | 적용 사례                            |
| ----------- | ------------------------------------ |
| 자동차 조립 | 조립공정 세부 고장코드 로깅          |
| 물류센터    | 컨베이어, 리프터 장애 발생 이력 기록 |
| 식음료      | 충진, 라벨링 반복 장애 분석          |
| 반도체      | 미세 센서 불량 빈도 통계             |

------

### ✅ 정리

- **에러코드 체계 설계는 안정적인 유지보수의 핵심 출발점**
- 단순히 경고만 출력하는 수준이 아니라
   **원인 → 이력 기록 → 분석 → 예방정비 → 품질 개선**으로 이어지는 전체 고장관리 흐름이 완성되어야 한다.
- 초기 설계시 **번호체계, 메시지 일관성, SCADA 연동구조**를 체계적으로 잡아두면
   **확장성·분석 가능성·장기 통합 운용 품질이 크게 향상**된다.